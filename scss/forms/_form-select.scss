// Select
//
// Replaces the browser default select with a custom one, mostly pulled from
// https://primer.github.io/.

.form-select {
  @extend %component, %form-input;

  --#{$prefix}widget-icon: #{svg-color($input-select-widget-icon, $input-default-idle-widget)};

  padding-right: #{calc(var(--#{$prefix}padding-x) * 2 + var(--#{$prefix}widget-size))};
  background-image: var(--#{$prefix}widget-icon), var(--#{$prefix}feedback-icon, none);
  background-repeat: no-repeat;
  background-position: $form-select-widget-position;
  background-size: var(--#{$prefix}widget-size);

  &[disabled],
  &:disabled {
    --#{$prefix}widget-icon: #{svg-color($input-select-widget-icon, $input-default-disabled-widget)};
  }

  &[multiple],
  &[size]:not([size="1"]) {
    padding-right: var(--#{$prefix}padding-x);
    background-image: none;
  }

  // Remove outline from select box in FF
  &:-moz-focusring {
    color: transparent;
    text-shadow: 0 0 0 var(--#{$prefix}fg-color);
  }

  @if $enable-alternate-forms {
    // .form-alternate &,
    .form-alternate &:not(&.form-default, .form-default &),
    .form-default .form-alternate &,
    &.form-alternate {
      --#{$prefix}widget-icon: #{svg-color($input-select-widget-icon, $input-alternate-idle-widget)};
      &[disabled],
      &:disabled {
        --#{$prefix}widget-icon: #{svg-color($input-select-widget-icon, $input-alternate-disabled-widget)};
      }
    }
  }

}

@mixin form-select-dark() {
  --#{$prefix}widget-icon: #{svg-color($input-select-widget-icon, $input-default-idle-widget, true)};

  &[disabled],
  &:disabled {
    --#{$prefix}widget-icon: #{svg-color($input-select-widget-icon, $input-default-disabled-widget, true)};
  }

  @if $enable-alternate-forms {
    &:not(
    .form-select.form-default,
    .form-default .form-select),
    &.form-alternate {
      --#{$prefix}widget-icon: #{svg-color($input-select-widget-icon, $input-alternate-idle-widget, true)};
      &[disabled],
      &:disabled {
        --#{$prefix}widget-icon: #{svg-color($input-select-widget-icon, $input-alternate-disabled-widget, true)};
      }
    }
  }

}

@if $enable-dark-mode {
  @include color-mode(dark) {
    @if $color-mode-type == "media-query" {
      .form-select {
        @include form-select-dark();
      }
    } @else {
      .form-select:not(
      .form-select[data-cx-theme="light"],
      [data-cx-theme="dark"] [data-cx-theme="light"] .form-select),
      &.form-select {
        @include form-select-dark();
      }
    }
  }
}
