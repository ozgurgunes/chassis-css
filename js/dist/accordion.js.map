{"version":3,"file":"accordion.js","sources":["../src/accordion.js"],"sourcesContent":["class Accordion {\n  constructor(el) {\n    // Store the <details> element\n    this.el = el\n    // Store the <summary> element\n    this.summary = el.querySelector('summary')\n    // Store the <div class=\"content\"> element\n    this.content = el.querySelector('.accordion-content')\n    // Store the animation object (so we can cancel it if needed)\n    this.animation = null\n    // Store if the element is closing\n    this.isClosing = false\n    // Store if the element is expanding\n    this.isExpanding = false\n    // Detect user clicks on the summary element\n    this.summary.addEventListener('click', e => this.onClick(e))\n  }\n\n  onClick(e) {\n    // Stop default behaviour from the browser\n    e.preventDefault()\n    // Add an overflow on the <details> to avoid content overflowing\n    this.el.style.overflow = 'hidden'\n    // Check if the element is being closed or is already closed\n    if (this.isClosing || !this.el.open) {\n      // Collapse other elements\n      // console.log(this.el.classList)\n      this.static = this.el.parentElement.classList.contains('static')\n      this.openItems = this.el.parentElement.querySelectorAll('details[open]')\n      if (!this.static && this.openItems) {\n        for (const e of this.openItems) {\n          const item = new Accordion(e)\n          // eslint-disable-next-line no-console\n          console.log(item.el)\n          if (item.el !== this.el) {\n            item.el.style.overflow = 'hidden'\n            item.shrink()\n          }\n        }\n      }\n      // this.mode = this.el.querySelector('data-cx-accordion')\n\n      // Store open elements\n      this.open()\n      // Check if the element is being openned or is already open\n    } else if (this.isExpanding || this.el.open) {\n      this.shrink()\n    }\n  }\n\n  shrink() {\n    // Set the element as \"being closed\"\n    this.isClosing = true\n\n    // Store the current height of the element\n    const startHeight = `${this.el.offsetHeight}px`\n    // Calculate the height of the summary\n    const endHeight = `${this.summary.offsetHeight}px`\n\n    // If there is already an animation running\n    if (this.animation) {\n      // Cancel the current animation\n      this.animation.cancel()\n    }\n\n    // Start a WAAPI animation\n    this.animation = this.el.animate(\n      {\n        // Set the keyframes from the startHeight to endHeight\n        height: [startHeight, endHeight]\n      },\n      {\n        duration: 300,\n        easing: 'ease-out'\n      }\n    )\n\n    // When the animation is complete, call onAnimationFinish()\n    this.animation.onfinish = () => this.onAnimationFinish(false)\n    // If the animation is cancelled, isClosing variable is set to false\n    this.animation.addEventListener('cancel', () => {\n      this.isClosing = false\n    })\n  }\n\n  open() {\n    // Apply a fixed height on the element\n    this.el.style.height = `${this.el.offsetHeight}px`\n    // Force the [open] attribute on the details element\n    this.el.open = true\n    // Wait for the next frame to call the expand function\n    window.requestAnimationFrame(() => this.expand())\n  }\n\n  expand() {\n    // Set the element as \"being expanding\"\n    this.isExpanding = true\n    // Get the current fixed height of the element\n    const startHeight = `${this.el.offsetHeight}px`\n    // Calculate the open height of the element (summary height + content height)\n    const endHeight = `${this.summary.offsetHeight + this.content.offsetHeight\n    }px`\n\n    // If there is already an animation running\n    if (this.animation) {\n      // Cancel the current animation\n      this.animation.cancel()\n    }\n\n    // Start a WAAPI animation\n    this.animation = this.el.animate(\n      {\n        // Set the keyframes from the startHeight to endHeight\n        height: [startHeight, endHeight]\n      },\n      {\n        duration: 300,\n        easing: 'ease-out'\n      }\n    )\n    // When the animation is complete, call onAnimationFinish()\n    this.animation.onfinish = () => this.onAnimationFinish(true)\n    // If the animation is cancelled, isExpanding variable is set to false\n    this.animation.addEventListener('cancel', () => {\n      this.isExpanding = false\n    })\n  }\n\n  onAnimationFinish(open) {\n    // Set the open attribute based on the parameter\n    this.el.open = open\n    // Clear the stored animation\n    this.animation = null\n    // Reset isClosing & isExpanding\n    this.isClosing = false\n    this.isExpanding = false\n    // Remove the overflow hidden and the fixed height\n    this.el.style.height = ''\n    this.el.style.overflow = ''\n  }\n}\n\nfor (const el of document.querySelectorAll('.accordion > details')) {\n  // eslint-disable-next-line no-new\n  new Accordion(el)\n}\n\nexport default Accordion\n"],"names":["Accordion","constructor","el","summary","querySelector","content","animation","isClosing","isExpanding","addEventListener","e","onClick","preventDefault","style","overflow","open","static","parentElement","classList","contains","openItems","querySelectorAll","item","console","log","shrink","startHeight","offsetHeight","endHeight","cancel","animate","height","duration","easing","onfinish","onAnimationFinish","window","requestAnimationFrame","expand","document"],"mappings":"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"}