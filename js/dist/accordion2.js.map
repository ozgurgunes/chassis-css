{"version":3,"file":"accordion2.js","sources":["../src/accordion2.js"],"sourcesContent":["/**\n * --------------------------------------------------------------------------\n * Chassis - CSS accordion.js\n * Licensed under MIT (https://github.com/ozgurgunes/chassis-css/blob/main/LICENSE)\n * --------------------------------------------------------------------------\n */\n\nimport BaseComponent from './base-component.js'\nimport SelectorEngine from './dom/selector-engine.js'\nimport EventHandler from './dom/event-handler.js'\nimport { defineJQueryPlugin } from './util/index.js'\n\nconst NAME = 'accordion'\n\nconst DATA_KEY = 'cx.accordion'\nconst EVENT_KEY = `.${DATA_KEY}`\nconst DATA_API_KEY = '.data-api'\n\nconst EVENT_OPEN = `open${EVENT_KEY}`\nconst EVENT_OPENED = `opened${EVENT_KEY}`\nconst EVENT_CLOSE = `close${EVENT_KEY}`\nconst EVENT_CLOSED = `closed${EVENT_KEY}`\n\nconst SELECTOR_DETAILS = '.accordion > details'\nconst SELECTOR_SUMMARY = 'summary'\nconst SELECTOR_CONTENT = '.accordion-body'\nconst EVENT_CLICK_DATA_API = `click${EVENT_KEY}${DATA_API_KEY}`\n\nclass Accordion extends BaseComponent {\n  static get NAME() {\n    return NAME\n  }\n\n  constructor(element, config) {\n    super(element, config)\n\n    this._summary = SelectorEngine.findOne(SELECTOR_SUMMARY, element)\n    this._content = SelectorEngine.findOne(SELECTOR_CONTENT, element)\n\n    this._isTransitioning = false\n\n    const observer = new MutationObserver(mutationsList => {\n      for (const mutation of mutationsList) {\n        if (mutation.type === 'attributes' && mutation.attributeName === 'open') {\n          if (this._element.open) {\n            this.open()\n          } else {\n            this.close()\n          }\n        }\n      }\n    })\n\n    observer.observe(this._element, { attributes: true })\n  }\n\n  open() {\n    if (this._isTransitioning) {\n      return\n    }\n\n    const startEvent = EventHandler.trigger(this._element, EVENT_OPEN)\n    if (startEvent.defaultPrevented) {\n      return\n    }\n\n    this._isTransitioning = true\n    this._summary.style['box-shadow'] = 'none'\n    this._element.style.overflow = 'hidden'\n    this._element.style.height = `${this._summary.offsetHeight}px`\n    this._element.style.height = `${this._summary.offsetHeight + this._content.offsetHeight}px`\n\n    const complete = () => {\n      this._isTransitioning = false\n      this._summary.style['box-shadow'] = ''\n      this._element.style.overflow = ''\n      this._element.style.height = ''\n      EventHandler.trigger(this._element, EVENT_OPENED)\n    }\n\n    this._queueCallback(complete, this._element, true)\n  }\n\n  close() {\n    if (this._isTransitioning) {\n      return\n    }\n\n    const startEvent = EventHandler.trigger(this._element, EVENT_CLOSE)\n    if (startEvent.defaultPrevented) {\n      return\n    }\n\n    this._isTransitioning = true\n    this._element.style.height = `${this._summary.offsetHeight + this._content.offsetHeight}px`\n    this._element.style.height = `${this._summary.offsetHeight}px`\n\n    const complete = () => {\n      this._isTransitioning = false\n      this._element.style.height = ''\n      EventHandler.trigger(this._element, EVENT_CLOSED)\n    }\n\n    this._queueCallback(complete, this._element, true)\n  }\n}\n\nEventHandler.on(document, EVENT_CLICK_DATA_API, SELECTOR_DETAILS, () => {\n  for (const element of SelectorEngine.find(SELECTOR_DETAILS)) {\n    Accordion.getOrCreateInstance(element)\n  }\n})\n\ndefineJQueryPlugin(Accordion)\n\nexport default Accordion\n"],"names":["NAME","DATA_KEY","EVENT_KEY","DATA_API_KEY","EVENT_OPEN","EVENT_OPENED","EVENT_CLOSE","EVENT_CLOSED","SELECTOR_DETAILS","SELECTOR_SUMMARY","SELECTOR_CONTENT","EVENT_CLICK_DATA_API","Accordion","BaseComponent","constructor","element","config","_summary","SelectorEngine","findOne","_content","_isTransitioning","observer","MutationObserver","mutationsList","mutation","type","attributeName","_element","open","close","observe","attributes","startEvent","EventHandler","trigger","defaultPrevented","style","overflow","height","offsetHeight","complete","_queueCallback","on","document","find","getOrCreateInstance","defineJQueryPlugin"],"mappings":";;;;;;;;;;;EAAA;EACA;EACA;EACA;EACA;EACA;;EAOA,MAAMA,IAAI,GAAG,WAAW;EAExB,MAAMC,QAAQ,GAAG,cAAc;EAC/B,MAAMC,SAAS,GAAG,CAAID,CAAAA,EAAAA,QAAQ,CAAE,CAAA;EAChC,MAAME,YAAY,GAAG,WAAW;EAEhC,MAAMC,UAAU,GAAG,CAAOF,IAAAA,EAAAA,SAAS,CAAE,CAAA;EACrC,MAAMG,YAAY,GAAG,CAASH,MAAAA,EAAAA,SAAS,CAAE,CAAA;EACzC,MAAMI,WAAW,GAAG,CAAQJ,KAAAA,EAAAA,SAAS,CAAE,CAAA;EACvC,MAAMK,YAAY,GAAG,CAASL,MAAAA,EAAAA,SAAS,CAAE,CAAA;EAEzC,MAAMM,gBAAgB,GAAG,sBAAsB;EAC/C,MAAMC,gBAAgB,GAAG,SAAS;EAClC,MAAMC,gBAAgB,GAAG,iBAAiB;EAC1C,MAAMC,oBAAoB,GAAG,CAAA,KAAA,EAAQT,SAAS,CAAA,EAAGC,YAAY,CAAE,CAAA;EAE/D,MAAMS,SAAS,SAASC,aAAa,CAAC;IACpC,WAAWb,IAAIA,GAAG;EAChB,IAAA,OAAOA,IAAI;EACb;EAEAc,EAAAA,WAAWA,CAACC,OAAO,EAAEC,MAAM,EAAE;EAC3B,IAAA,KAAK,CAACD,OAAO,EAAEC,MAAM,CAAC;MAEtB,IAAI,CAACC,QAAQ,GAAGC,cAAc,CAACC,OAAO,CAACV,gBAAgB,EAAEM,OAAO,CAAC;MACjE,IAAI,CAACK,QAAQ,GAAGF,cAAc,CAACC,OAAO,CAACT,gBAAgB,EAAEK,OAAO,CAAC;MAEjE,IAAI,CAACM,gBAAgB,GAAG,KAAK;EAE7B,IAAA,MAAMC,QAAQ,GAAG,IAAIC,gBAAgB,CAACC,aAAa,IAAI;EACrD,MAAA,KAAK,MAAMC,QAAQ,IAAID,aAAa,EAAE;UACpC,IAAIC,QAAQ,CAACC,IAAI,KAAK,YAAY,IAAID,QAAQ,CAACE,aAAa,KAAK,MAAM,EAAE;EACvE,UAAA,IAAI,IAAI,CAACC,QAAQ,CAACC,IAAI,EAAE;cACtB,IAAI,CAACA,IAAI,EAAE;EACb,WAAC,MAAM;cACL,IAAI,CAACC,KAAK,EAAE;EACd;EACF;EACF;EACF,KAAC,CAAC;EAEFR,IAAAA,QAAQ,CAACS,OAAO,CAAC,IAAI,CAACH,QAAQ,EAAE;EAAEI,MAAAA,UAAU,EAAE;EAAK,KAAC,CAAC;EACvD;EAEAH,EAAAA,IAAIA,GAAG;MACL,IAAI,IAAI,CAACR,gBAAgB,EAAE;EACzB,MAAA;EACF;MAEA,MAAMY,UAAU,GAAGC,YAAY,CAACC,OAAO,CAAC,IAAI,CAACP,QAAQ,EAAExB,UAAU,CAAC;MAClE,IAAI6B,UAAU,CAACG,gBAAgB,EAAE;EAC/B,MAAA;EACF;MAEA,IAAI,CAACf,gBAAgB,GAAG,IAAI;MAC5B,IAAI,CAACJ,QAAQ,CAACoB,KAAK,CAAC,YAAY,CAAC,GAAG,MAAM;EAC1C,IAAA,IAAI,CAACT,QAAQ,CAACS,KAAK,CAACC,QAAQ,GAAG,QAAQ;EACvC,IAAA,IAAI,CAACV,QAAQ,CAACS,KAAK,CAACE,MAAM,GAAG,CAAA,EAAG,IAAI,CAACtB,QAAQ,CAACuB,YAAY,CAAI,EAAA,CAAA;EAC9D,IAAA,IAAI,CAACZ,QAAQ,CAACS,KAAK,CAACE,MAAM,GAAG,CAAG,EAAA,IAAI,CAACtB,QAAQ,CAACuB,YAAY,GAAG,IAAI,CAACpB,QAAQ,CAACoB,YAAY,CAAI,EAAA,CAAA;MAE3F,MAAMC,QAAQ,GAAGA,MAAM;QACrB,IAAI,CAACpB,gBAAgB,GAAG,KAAK;QAC7B,IAAI,CAACJ,QAAQ,CAACoB,KAAK,CAAC,YAAY,CAAC,GAAG,EAAE;EACtC,MAAA,IAAI,CAACT,QAAQ,CAACS,KAAK,CAACC,QAAQ,GAAG,EAAE;EACjC,MAAA,IAAI,CAACV,QAAQ,CAACS,KAAK,CAACE,MAAM,GAAG,EAAE;QAC/BL,YAAY,CAACC,OAAO,CAAC,IAAI,CAACP,QAAQ,EAAEvB,YAAY,CAAC;OAClD;MAED,IAAI,CAACqC,cAAc,CAACD,QAAQ,EAAE,IAAI,CAACb,QAAQ,EAAE,IAAI,CAAC;EACpD;EAEAE,EAAAA,KAAKA,GAAG;MACN,IAAI,IAAI,CAACT,gBAAgB,EAAE;EACzB,MAAA;EACF;MAEA,MAAMY,UAAU,GAAGC,YAAY,CAACC,OAAO,CAAC,IAAI,CAACP,QAAQ,EAAEtB,WAAW,CAAC;MACnE,IAAI2B,UAAU,CAACG,gBAAgB,EAAE;EAC/B,MAAA;EACF;MAEA,IAAI,CAACf,gBAAgB,GAAG,IAAI;EAC5B,IAAA,IAAI,CAACO,QAAQ,CAACS,KAAK,CAACE,MAAM,GAAG,CAAG,EAAA,IAAI,CAACtB,QAAQ,CAACuB,YAAY,GAAG,IAAI,CAACpB,QAAQ,CAACoB,YAAY,CAAI,EAAA,CAAA;EAC3F,IAAA,IAAI,CAACZ,QAAQ,CAACS,KAAK,CAACE,MAAM,GAAG,CAAA,EAAG,IAAI,CAACtB,QAAQ,CAACuB,YAAY,CAAI,EAAA,CAAA;MAE9D,MAAMC,QAAQ,GAAGA,MAAM;QACrB,IAAI,CAACpB,gBAAgB,GAAG,KAAK;EAC7B,MAAA,IAAI,CAACO,QAAQ,CAACS,KAAK,CAACE,MAAM,GAAG,EAAE;QAC/BL,YAAY,CAACC,OAAO,CAAC,IAAI,CAACP,QAAQ,EAAErB,YAAY,CAAC;OAClD;MAED,IAAI,CAACmC,cAAc,CAACD,QAAQ,EAAE,IAAI,CAACb,QAAQ,EAAE,IAAI,CAAC;EACpD;EACF;EAEAM,YAAY,CAACS,EAAE,CAACC,QAAQ,EAAEjC,oBAAoB,EAAEH,gBAAgB,EAAE,MAAM;IACtE,KAAK,MAAMO,OAAO,IAAIG,cAAc,CAAC2B,IAAI,CAACrC,gBAAgB,CAAC,EAAE;EAC3DI,IAAAA,SAAS,CAACkC,mBAAmB,CAAC/B,OAAO,CAAC;EACxC;EACF,CAAC,CAAC;AAEFgC,6BAAkB,CAACnC,SAAS,CAAC;;;;;;;;"}