<nav class="cxd-links w-100" id="cxd-docs-nav" aria-label="Docs navigation">
  {{- $url := split .Permalink "/" -}}
  {{- $page_slug := index $url (sub (len $url) 2) -}}

  <ul class="cxd-links-nav bulletless">
  {{- range $group := .Site.Data.sidebar -}}
    {{- $link := $group.title -}}
    {{- $link_slug := $link | urlize -}}

    {{- if $group.pages -}}
      {{- $link = index $group.pages 0 -}}
      {{- $link_slug = $link.title | urlize -}}
    {{- end -}}

    {{- $group_slug := $group.title | urlize -}}
    {{- $is_active_group := eq $.Page.Params.group $group_slug -}}

    {{- if $group.pages }}
      <li class="cxd-links-group py-small">
        <strong class="cxd-links-heading d-flex w-100 align-items-center">
          {{- if $group.icon }}
            <svg class="bi me-small" aria-hidden="true"><use xlink:href="#{{ $group.icon }}"></use></svg>
          {{- end }}
          {{ $group.title }}
        </strong>

        <ul class="bulletless fw-normal font-small">
          {{- range $doc := $group.pages -}}
            {{- $doc_slug := $doc.title | urlize -}}
            {{- $is_active := and $is_active_group (eq $page_slug $doc_slug) -}}
            {{- $href := urls.JoinPath "/docs" $.Site.Params.docs_version $group_slug $doc_slug "/" }}
            <li><a href="{{ $href }}" class="cxd-links-link d-inline-block{{ if $is_active }} active{{ end }}"{{ if $is_active }} aria-current="page"{{ end }}>{{ $doc.title }}</a></li>
          {{- end }}
        </ul>
      </li>
    {{- else }}
      <li class="cxd-links-span-all border-top my-small mx-small cx-border-subtle"></li>
      <li class="cxd-links-span-all">
        {{- $href := urls.JoinPath "/docs" $.Site.Params.docs_version $group_slug "/" }}
        <a href="{{ $href }}" class="cxd-links-link d-inline-block small{{ if $is_active_group }} active{{ end }}"{{ if $is_active_group }} aria-current="page"{{ end }}>
          {{ $group.title }}
        </a>
      </li>
    {{- end }}
  {{- end }}
  </ul>
</nav>
<script>
  var el = document.querySelector('.cxd-links-link.active')
  var parent = el.parentElement.parentElement.parentElement
  //window.onload = console.log(parent)
  window.onload = parent.classList.add('active')
</script>
